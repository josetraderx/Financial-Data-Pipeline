                                    ┌────────────┐
                                    │  START ETL │
                                    └─────┬──────┘
                                          │
                                          ▼
                             ┌──────────────────────────┐
                             │ Send HTTP request to API │
                             └────────────┬─────────────┘
                                          │
                                          ▼
                         ┌─────────────────────────────────┐
                         │ Receive HTTP status code (SC)  │
                         └────────────┬────────────────────┘
                                      │
               ┌──────────────────────┼───────────────────────┐
               │                      │                       │
               ▼                      ▼                       ▼
         ┌───────────┐          ┌──────────────┐        ┌───────────┐
         │ SC = 200  │          │ SC in 4xx    │        │ SC in 5xx │
         │ Success   │          │ Client errs. │        │ Server err│
         └────┬──────┘          └──────┬───────┘        └────┬──────┘
              │                          │                     │
              ▼                          │                     │
   ┌────────────────────┐                │                     │
   │ Process and store  │ Handle specific │       Handle 5xx:   │
   │ data, continue ETL │ codes:           │ • Retry w/ backoff │
   └────────────────────┘                │ • Alert & dead-    │
                                         │   letter if max    │
                                         │                     │
                    ┌────────────────────┴───────────┐
                    │ SC in {400,401,403,404,408,429, │
                    │          502,503,504}           │
                    └────────────────────┬───────────┘
                                         │
         ┌───────────────────────────────┼───────────────────────────────┐
         │                               │                               │
         ▼                               ▼                               ▼
 ┌─────────────────┐             ┌─────────────────┐             ┌─────────────────┐
 │ 400 Bad Request │             │ 401 / 403 Auth  │             │   404 Not Found │
 │ • Log & fail‑  │             │ • Refresh token │             │ • Record for    │
 │   fast          │             │   or alert      │             │   reconciliation│
 └─────────────────┘             └─────────────────┘             └─────────────────┘

         ┌───────────────────────────────┐
         │ SC in {408,504 Gateway Timeout}  │
         │ • Retry w/ backoff              │
         └───────────────────────────────┘

         ┌───────────────────────────────┐
         │ 429 Too Many Requests         │
         │ • Backoff + respect headers   │
         └───────────────────────────────┘

         ┌───────────────────────────────┐
         │ 502 / 503                     │
         │ • Retry w/ backoff + jitter   │
         │ • Respect Retry-After header  │
         └───────────────────────────────┘

                    ┌────────────────────┐
                    │ Other codes (e.g.  │
                    │ 3xx, 507, etc.)    │
                    │ • Log + Alert      │
                    │ • Dead-letter      │
                    └────────────────────┘
